<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Test file</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <script src="jtr.js"></script>
</head>
<body>

<script type="text/javascript">
	var tested = false;
	var result = false;
	var msg = "";
	var ready = false;

        ontestready = OnTestReady;

	function logResult ()
	{
		if (ready && tested) {
			if (result == 0) {
		                var moonlight_control = document.getElementById ("JoltActiveX");
				TestLogger.LogResult (result);
				TestHost.TakeSingleSnapshotAndShutdown (moonlight_control, "video-seek.html.png", 100, 100);
			} else {
				TestLogger.LogError (msg);
				TestLogger.LogResult (result);
				TestHost.SignalShutdown ();
			}
		}
	}
	
        function OnTestReady ()
        {
		ready = true;
		logResult ();
        }

        function ErrorHandler (sender, args)
        {
            TestLogger.LogError (args.toString ());
            TestLogger.LogResult (-1);
        }

	function onLoaded (o, e)
	{
		var ml = document.getElementById ("JoltActiveX");
		var me = ml.content.findName ("TestVideo");
		me.Position = "00:00:07.000";

		if (me.Position.Seconds == 7) {
			result = 0;
		} else {
			result = -1;
			msg = "Expected 7 seconds, got " + me.Position.Seconds + " seconds.";
		}
		tested = true;
		logResult ();
	}

	function onStateChanged (o, e)
	{
	}

</script>

<div>
<embed type="application/x-silverlight" width="1280" height="720"
     id="JoltActiveX" Source="video.xaml" OnError="ErrorHandler" OnLoad="onLoaded"
     style="position:absolute; left:0px; top:0px" background="#CCCCCC">
</embed>
</div>

</body>
</body>
</html>




