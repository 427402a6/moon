<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<title>Collections test</title>
<meta></meta>
</head>
<body>

<script type="text/javascript">
function Log (content, textblock, message)
{
textblock.printf (message);
	var run = content.createFromXaml ("<Run/>");
	run.text = message;
	
	if (textblock.inlines == null) {
		textblock.text = "";
	}
	
	textblock.inlines.add (run);
	run = content.createFromXaml ("<LineBreak/>");
	textblock.inlines.add (run);
}

function OnLoaded (sender, eventArgs)
{
	var control = document.getElementById ("agControl");
	var content = control.content;
	
	var canvas1 = content.findName ("canvas1");
	var canvas2 = content.findName ("canvas2");
	var log = content.findName ("log");
	var index, count;
	
	var xaml = "<Image Source='moonlight_logo.png'/>";
	var image = content.createFromXaml (xaml);
	
	// add the image to canvas1
	index = canvas1.children.add (image);
	Log (content, log, "canvas1.children.add (image) => " + index);
	
	// try adding it to canvas1 again (should fail?)
	canvas1.children.insert (1, image);
	count = canvas1.children.count;
	Log (content, log, "canvas1.children.insert (1, image) => worked");
	
	// try adding it to canvas2
	index = canvas2.children.add (image);
	Log (content, log, "canvas2.children.add (image) => " + index);
}
</script>

<object type="application/x-silverlight" data="data:," id="agControl" width="100%" height="100%">
<param name="background" value="#FFFFFF"/>
<param name="source" value="#xamlContent"/>
</object>

<script type="text/xaml" id="xamlContent">
<?xml version="1.0"?>
<Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Loaded="OnLoaded">

  <Canvas x:Name="canvas1" Canvas.Left="5" Canvas.Top="5" Width="400" Height="195" Background="Red"/>

  <Canvas x:Name="canvas2" Canvas.Left="5" Canvas.Top="205" Width="400" Height="195" Background="Blue"/>

  <TextBlock x:Name="log" Canvas.Left="5" Canvas.Top="400" Width="400" TextWrapping="WrapWithOverflow"/>
</Canvas>
</script>

</body>
</html>
