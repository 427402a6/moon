<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<title>NameScope test</title>
<meta></meta>
</head>
<body>

<script type="text/javascript">
var control = null;
var content = null;
var logger = null;

function Log (color, text)
{
        var run = content.createFromXaml ("<Run Foreground='" + color + "'/>");
        var eoln = content.createFromXaml ("<LineBreak/>");
        
        run.text = text;
        logger.inlines.add (run);
        logger.inlines.add (eoln);
}

function OnLoaded (sender, eventArgs)
{
        control = document.getElementById ("agControl");
        content = control.content;
        
        logger = sender.findName ("Log");
        
        // first test is to see what happens when a named brush is set
        // as a property on multiple elements in the same NameScope.
        
        var tree0 = content.createFromXaml ("<Canvas xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation' xmlns:x='http://schemas.microsoft.com/winfx/2006/xaml' Canvas.Top='5' Canvas.Left='5' x:Name='Tree0'><Rectangle x:Name='Rect0' Canvas.Left='0' Width='10' Height='10'/><Rectangle x:Name='Rect1' Canvas.Left='15' Width='10' Height='10'/></Canvas>", true);
        var brush = content.createFromXaml ("<SolidColorBrush Color='Green'/>");
        brush.name = "MyBrush";
        
        sender.children.add (tree0);
        
        var rect = tree0.findName ("Rect0");
        rect.stroke = brush;
        
        rect = tree0.findName ("Rect1");
        rect.fill = brush;
        
        var res = tree0.findName ("MyBrush");
        if (res == brush)
                Log ("green", "FindName() found the re-used brush as expected.");
        else
                Log ("red", "FindName() did not find the re-used brush.");
        
        // now we need to see if we can re-use the same brush in a second
        // namespace and whether or not FindName() will find it in both places.
        
        var tree1 = content.createFromXaml ("<Canvas xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation' xmlns:x='http://schemas.microsoft.com/winfx/2006/xaml' Canvas.Top='5' Canvas.Left='35' x:Name='Tree1'><Rectangle x:Name='Rect2' Canvas.Left='0' Width='10' Height='10'/><Rectangle x:Name='Rect3' Canvas.Left='15' Width='10' Height='10'/></Canvas>", true);
        sender.children.add (tree1);
        
        rect = tree1.findName ("Rect2");
        rect.stroke = brush;
        
        rect = tree1.findName ("Rect3");
        rect.fill = brush;
        
        res = tree1.findName ("MyBrush");
        if (res == brush)
                Log ("green", "FindName() found the re-used brush in the alternate namescope as expected.");
        else
                Log ("red", "FindName() did not find the re-used brush in the alternate namescope.");
}
</script>

<object type="application/x-silverlight" data="data:," id="agControl" width="100%" height="100%">
<param name="background" value="#FFFFFF"/>
<param name="source" value="#xamlContent"/>
</object>

<script type="text/xaml" id="xamlContent">
<?xml version="1.0"?>
<Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Loaded="OnLoaded">
  <TextBlock Canvas.Left="5" Canvas.Top="25" x:Name="Log"/>
</Canvas>
</script>

</body>
</html>
